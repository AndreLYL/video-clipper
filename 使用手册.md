# 视频裁剪工具 - 详细使用手册

## 目录
1. [快速开始](#快速开始)
2. [功能说明](#功能说明)
3. [使用教程](#使用教程)
4. [常见问题](#常见问题)
5. [技巧和建议](#技巧和建议)

---

## 快速开始

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python video_clipper.py
```

### 打包为EXE
```bash
build.bat
```
打包完成后，EXE文件位于 `dist` 文件夹中。

---

## 功能说明

### 主要功能
- **单点裁剪**: 裁剪单个指定时间点的视频片段
- **批量裁剪**: 从文本文件读取多个时间点，批量裁剪视频
- **自动裁剪**: 预留功能（暂未实现）

### 裁剪规则
- 裁剪时长: **前40秒 + 后20秒 = 共60秒**
- 例如: 指定时间点 `10:05:30`
  - 实际裁剪: `10:04:50` ~ `10:05:50`

### 文件命名
- 单点裁剪: `HH-MM-SS.mp4` (例: `10-05-30.mp4`)
- 批量裁剪: `HH-MM-SS_描述.mp4` (例: `10-05-30_第一个片段.mp4`)

---

## 使用教程

### 一、单点裁剪模式

#### 步骤1: 选择源视频
1. 点击"源视频文件"旁的 **[浏览]** 按钮
2. 选择需要裁剪的视频文件
3. 支持格式: MP4, AVI, MOV, MKV, FLV等

#### 步骤2: 选择目标目录
1. 点击"目标目录"旁的 **[浏览]** 按钮
2. 选择裁剪后视频的保存位置
3. 如果目录不存在，程序会自动创建

#### 步骤3: 选择裁剪模式
- 选择 **"单点裁剪"** 单选按钮

#### 步骤4: 输入时间参数
1. **视频起始时间 (UTC)**: 输入视频录制开始时的UTC时间
   - 格式: `HH:MM:SS`
   - 例如: `10:00:00` 表示上午10点

2. **裁剪时间点**: 输入想要裁剪的具体时间点
   - 格式: `HH:MM:SS`
   - 例如: `10:05:30` 表示上午10点5分30秒

#### 步骤5: 开始裁剪
1. 点击 **[开始裁剪]** 按钮
2. 等待进度条完成
3. 完成后会弹出成功提示

#### 实例演示
```
源视频: D:\Videos\recording.mp4
目标目录: D:\Output\
视频起始时间: 10:00:00
裁剪时间点: 10:05:30

结果:
- 裁剪视频片段: 10:04:50 ~ 10:05:50 (60秒)
- 保存为: D:\Output\10-05-30.mp4
```

---

### 二、批量裁剪模式

#### 步骤1-2: 同单点裁剪
选择源视频和目标目录

#### 步骤3: 选择裁剪模式
- 选择 **"批量裁剪"** 单选按钮

#### 步骤4: 准备时间戳文件
创建一个文本文件（例如 `timestamps.txt`），格式如下:

```
# 这是注释，会被忽略
# 格式: HH:MM:SS 描述

10:05:30 第一个重要片段
10:15:45 第二个重要片段
10:30:00 第三个重要片段
11:00:15 第四个重要片段
```

**格式说明**:
- 每行一个时间点
- 时间格式: `HH:MM:SS`
- 空格后可添加描述（可选）
- `#` 开头的行为注释
- 空行会被自动忽略

#### 步骤5: 输入时间参数
1. **视频起始时间 (UTC)**: 输入视频录制开始时的UTC时间
   - 格式: `HH:MM:SS`
   - 例如: `10:00:00`

2. **时间戳文件**: 点击 **[选择文件]** 按钮，选择准备好的时间戳文件

#### 步骤6: 开始裁剪
1. 点击 **[开始裁剪]** 按钮
2. 程序会依次处理每个时间点
3. 进度标签会显示当前处理进度
4. 完成后显示成功和失败的统计

#### 实例演示
```
源视频: D:\Videos\long_recording.mp4
目标目录: D:\Output\clips\
视频起始时间: 10:00:00
时间戳文件: D:\timestamps.txt

时间戳文件内容:
10:05:30 开场
10:15:45 精彩片段
10:30:00 结束语

结果:
- D:\Output\clips\10-05-30_开场.mp4
- D:\Output\clips\10-15-45_精彩片段.mp4
- D:\Output\clips\10-30-00_结束语.mp4
```

---

## 常见问题

### Q1: 提示"裁剪时间超出视频范围"怎么办？
**原因**: 
- 指定的时间点太早（前40秒超出视频开头）
- 指定的时间点太晚（后20秒超出视频结尾）

**解决方法**:
- 确保时间点在视频时长范围内
- 时间点至少要晚于视频起始时间40秒
- 时间点至少要早于视频结束时间20秒

### Q2: 提示"时间格式错误"怎么办？
**原因**: 输入的时间格式不正确

**正确格式**: `HH:MM:SS`
- HH: 小时（00-23）
- MM: 分钟（00-59）
- SS: 秒（00-59）

**正确示例**: 
- `09:05:30` ✓
- `12:00:00` ✓
- `23:59:59` ✓

**错误示例**: 
- `9:5:30` ✗ (小时和分钟需要两位数)
- `12:60:00` ✗ (分钟不能超过59)
- `25:00:00` ✗ (小时不能超过23)

### Q3: 批量裁剪时部分失败怎么办？
**原因**: 
- 某些时间点格式错误
- 某些时间点超出视频范围
- 视频文件损坏

**解决方法**:
- 查看完成提示中的失败详情
- 检查并修正时间戳文件中的错误行
- 确保所有时间点在合理范围内

### Q4: 视频裁剪很慢怎么办？
**原因**: 
- 视频文件较大
- 视频编码格式复杂
- 电脑性能限制

**建议**:
- 这是正常现象，视频处理需要时间
- 1分钟的视频通常需要10-30秒处理时间
- 批量裁剪时请耐心等待

### Q5: 能否修改裁剪时长？
**当前版本**: 固定为前40秒+后20秒

**如需修改**: 需要修改源代码中的参数
```python
# 在 video_clipper.py 中找到这两行:
start_time = relative_seconds - 40  # 修改40为你想要的前置秒数
end_time = relative_seconds + 20    # 修改20为你想要的后置秒数
```

---

## 技巧和建议

### 1. 时间戳文件管理
- 为不同的视频创建单独的时间戳文件
- 在时间戳文件中使用注释记录视频信息
- 文件命名建议: `视频名_timestamps.txt`

### 2. 批量处理建议
- 首先用单点裁剪测试一两个点，确认参数正确
- 确认无误后再进行批量裁剪
- 大批量任务建议分批处理

### 3. 文件组织
- 为每个项目创建单独的输出目录
- 使用有意义的描述，方便后续查找
- 定期备份重要的裁剪结果

### 4. 性能优化
- 关闭其他占用CPU的程序
- 确保硬盘有足够的空间
- SSD硬盘会比HDD更快

### 5. 测试建议
- 使用 `test_video_generator.py` 生成测试视频
- 先在测试视频上验证功能
- 确认一切正常后再处理重要视频

### 6. 时间计算技巧
如果你知道相对时间（从视频开始的秒数），可以这样计算UTC时间:

```
视频起始时间: 10:00:00
相对时间: 330秒 (5分30秒)

计算: 10:00:00 + 5分30秒 = 10:05:30
裁剪时间点输入: 10:05:30
```

---

## 附录

### A. 支持的视频格式
- MP4 (推荐)
- AVI
- MOV
- MKV
- FLV
- WMV
- 其他常见视频格式

### B. 输出视频规格
- 格式: MP4
- 视频编码: H.264
- 音频编码: AAC
- 保留原视频的分辨率和帧率

### C. 系统要求
- 操作系统: Windows 10 或更高版本
- Python: 3.7+ (运行源代码时)
- 内存: 至少2GB可用内存
- 硬盘: 根据视频大小预留足够空间

### D. 联系与支持
- 遇到问题请保存错误截图
- 记录操作步骤以便问题重现
- 检查是否有软件更新

---

**祝您使用愉快！**

